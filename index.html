<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>OneDrive Text Editor</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196f3">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
</head>
<body>

    <div id="app">
        <header>
            <h1>OneDrive Text Editor</h1>
            <div id="auth-container">
                <button id="signin-button">Sign In with Microsoft</button>
                <button id="signout-button" style="display: none;">Sign Out</button>
            </div>
        </header>

        <main id="main-content" style="display: none;">
            <div id="file-controls">
                <button id="new-file-button">New</button>
                <button id="open-file-button">Open</button>
                <button id="save-file-button" disabled>Save</button>
                <button id="save-as-button" disabled>Save As</button>
                <button id="close-file-button" disabled>Close</button>
                <button id="word-wrap-button">WW</button>
                <button id="select-all-button" disabled>Select All</button>
            </div>
            <div id="file-info">
                <p>No file selected.</p>
            </div>
            <div id="editor-container"></div>
        </main>
    </div>

    <!-- The new File Picker Modal -->
    <div id="file-picker-modal" class="modal-hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-path">OneDrive</h2>
                <button id="modal-close-button">&times;</button>
            </div>
            <ul id="file-list">
                <!-- File and folder items will be inserted here by JavaScript -->
            </ul>
            <div id="save-as-container" style="display: none;">
                <input type="text" id="save-as-filename" placeholder="Enter filename...">
                <button id="save-as-confirm-button">Save Here</button>
            </div>
        </div>
    </div>

    <!-- MSAL.js -->
    <script src="https://alcdn.msauth.net/browser/2.14.2/js/msal-browser.min.js"></script>

    <!-- Import Map for CodeMirror 6 ESM modules -->
    <script type="importmap">
    {
        "imports": {
            "@codemirror/view": "https://esm.sh/@codemirror/view@6.26.3",
            "@codemirror/state": "https://esm.sh/@codemirror/state@6.4.1",
            "@codemirror/lang-javascript": "https://esm.sh/@codemirror/lang-javascript@6.2.2",
            "@codemirror/lang-markdown": "https://esm.sh/@codemirror/lang-markdown@6.2.5",
            "@codemirror/lang-python": "https://esm.sh/@codemirror/lang-python@6.1.6",
            "@codemirror/lang-html": "https://esm.sh/@codemirror/lang-html@6.4.9",
            "@codemirror/lang-css": "https://esm.sh/@codemirror/lang-css@6.2.1",
            "@codemirror/lang-json": "https://esm.sh/@codemirror/lang-json@6.0.1",
            "@codemirror/lang-xml": "https://esm.sh/@codemirror/lang-xml@6.1.0",
            "@codemirror/lang-php": "https://esm.sh/@codemirror/lang-php@6.0.1",
            "@codemirror/lang-java": "https://esm.sh/@codemirror/lang-java@6.0.1",
            "@codemirror/lang-cpp": "https://esm.sh/@codemirror/lang-cpp@6.0.2",
            "@codemirror/lang-rust": "https://esm.sh/@codemirror/lang-rust@6.0.1",
            "@codemirror/lang-sql": "https://esm.sh/@codemirror/lang-sql@6.7.0",
            "@codemirror/language": "https://esm.sh/@codemirror/language@6.10.1",
            "@codemirror/commands": "https://esm.sh/@codemirror/commands@6.5.0",
            "@codemirror/search": "https://esm.sh/@codemirror/search@6.5.6",
            "@codemirror/autocomplete": "https://esm.sh/@codemirror/autocomplete@6.15.0",
            "@codemirror/lint": "https://esm.sh/@codemirror/lint@6.5.0",
            "@lezer/highlight": "https://esm.sh/@lezer/highlight@1.2.0",
            "@codemirror/theme-one-dark": "https://esm.sh/@codemirror/theme-one-dark@6.1.2"
        }
    }
    </script>

    <!-- Main App Script -->
    <script type="module" src="script.js"></script>

</body>
</html>